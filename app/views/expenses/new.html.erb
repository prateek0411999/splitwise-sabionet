<h1>New Expense</h1>

<%= form_with(model: @expense, url: expenses_path) do |form| %>
  <div class="form-group">
    <%= form.label :type %>
    <%= form.select :expense_type, Expense.expense_types.keys, {}, class: 'expense-type-select form-control' %>
  </div>
  
  <div class="form-group">
    <%= form.label :total_amount %>
    <%= form.text_field :total_amount, class: "form-control", placeholder: "0.0" %>
  </div>

  <div class="form-group">
    <%= form.label :sharers %>
    <%= form.select :sharer_ids, options_for_select(@users.map{ |user| [user.email, user.id] }), { include_blank: false }, {multiple: true, required: true} %>
  </div>

  <div class="form-group">
    <%= form.label :payer_id %>
    <%= form.collection_select :payer_id, @users, :id, :email, { selected: current_user.id }, prompt: "Select payer" %>
  </div>

  <div class="form-group">
    <%= form.label :split_type %>
    <%= form.select :split_type, { "Equally" => :equally, "Unequally" => :unequally } %>
  </div>

  <%= form.submit "Create Expense" %>
<% end %>

<%# <script>
  document.addEventListener('DOMContentLoaded', function() {
    const expenseTypeSelect = document.querySelector('.expense-type-select');
    
    const itemFields = document.getElementById('item-fields');

    expenseTypeSelect.addEventListener('change', function() {
      if (this.value === 'itemized') {
        itemFields.style.display = 'block';
      } else {
        itemFields.style.display = 'none';
      }
    });
  });
</script> %>
